{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block page_content %}
<div class="row">
    <div class="col-sm-8">
        <!-- <div class="thumbnail">
            <img src="..." alt="...">
            <div class="caption">
                <h3>{{ career.name }}</h3>
                <p>{{ career.overview }}</p>
            </div>          
        </div> -->
        <div class="thumbnail">
            <!-- <img src="..." alt="..."> -->
           <!--  <h3>{{ career.name }}</h3> -->
            <div class="caption">
                <h3>{{ career.name }}</h3>
                <ul id="myTab" class='nav nav-tabs nav-justified '>
                    <li class="active"><a href="#overview" data-toggle="tab">Summary</a></li>
                    <li><a href="#duties" data-toggle="tab">Duties</a></li>
                    <li><a href="#education" data-toggle="tab">Learning Path</a></li>
                    <li><a href="work-environment" data-toggle="tab">Environment</a></li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane fade in active" id="overview">
                        <p>{{ career.summary|linebreaks }}</p>
                    </div>
                    <div class="tab-pane fade" id="duties">
                        <p>{{ career.duties|linebreaks }}</p>
                    </div>
                    <div class="tab-pane fade" id="education">
                        <p>{{ career.learning_path|linebreaks }}</p>
                    </div>
                    <div class="tab-pane fade" id="work-environment">
                        <p>{{ career.work_environment|linebreaks }}</p>
                    </div>
                </div>
            </div>          
        </div>

        <p class='lead'>Comments</p>
            {{ comments.count }} Comments
            {% if request.user.is_authenticated %}
            <form method="POST" action="."> {% csrf_token %}
                {{ comment_form|crispy }}
                <input type='submit' value='Post comment' class='btn btn-default'>
            </form>
            {% else %}
            <p>You must login to comment </p>
            {% endif %}
        <hr/>

        {% for comment in comments %}

        <blockquote>
          <p>{{ comment.content }}</p>
          <footer>via {{ comment.user }} | {{ comment.timestamp|timesince }} ago | {% if comment.children.count > 0 %}{{ comment.children.count }} Repl{% if comment.children.count > 1 %}ies{% else %}y{% endif %} | {% endif %} <a class='comment-reply-btn' href='#'>Reply</a> | <a class='' href='{{ comment.get_absolute_url }}'>Thread</a></footer>
          <div class='comment-reply'>
              {% for child_comment in comment.children %}
                <blockquote>
                    <p>{{ child_comment.content }}</p>
                    <footer>via {{ child_comment.user }} | {{ child_comment.timestamp|timesince }} ago</footer>
                </blockquote>
             {% endfor %}

             {% if request.user.is_authenticated %}
            <form method="POST" action="."> {% csrf_token %}
                {{ comment_form|crispy }}
                <input type='hidden' name='parent_id' value='{{ comment.id }}'>
                <input type='submit' value='Reply' class='btn btn-default'>
            </form>
            {% else %}
            <p>You must login to comment </p>
            {% endif %}
        </div>

        </blockquote>

        <hr/>
        {% endfor %}
    </div>
 </div>       
{% endblock %}

